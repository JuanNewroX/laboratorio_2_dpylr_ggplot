add_header_above(c("Mes con mas demanda sumando los dos anhos" = 2))
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt),
demanda =  max(cantidad)
) %>% demanda =  max(cantidad) %>% View()
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt),
demanda =  max(cantidad)
) %>% demanda =  max(cantidad) ) %>% Vi
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt),
demanda =  max(cantidad)
) %>% View()
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad)
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% View()
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable() %>%
add_header_above(c("Mes con mas demanda sumando los dos anhos" = 2))
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(format = "html", booktabs = T) %>%
add_header_above(c("Mes con mas demanda sumando los dos anhos" = 2))
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique(format = "html", booktabs = T) %>%  kable() %>%
add_header_above(c("Mes con mas demanda en cada anho" = 3))
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable() %>%
add_header_above(c("Mes con mas demanda en cada anho" = 3))
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique(format = "html", booktabs = T) %>%  kable() %>%
add_header_above(c("Mes con mas demanda en cada anho" = 3))
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique(format = "html", booktabs = T) %>%  kable() %>%
add_header_above(c("Mes con mas demanda en cada anho" = 3))
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(booktabs = T) %>%
add_header_above(c("Mes con mas demanda general" = 2))
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(booktabs = T)
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(booktabs = T) %>%
add_header_above(c("Mes con mas demanda general" = 2))
cat("Tabla 1. Mes con mas demanda en cada anho")
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable()
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable() %>%
add_header_above(c("Mes con mas demanda general" = 2))
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable()
cat("Tabla 1.2 Mes con mas demanda general")
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable()
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(booktabs = T)
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique(boof) %>%  kable(booktabs = T)
cat("Tabla 1.2 Mes con mas demanda general")
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable(booktabs = T)
cat("Tabla 1.2 Mes con mas demanda general")
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable_classic(full_width = F, html_font = "Cambria")
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable(booktabs = T) %>% kable_minimal()
library(kableExtra)
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable(booktabs = T) %>% kable_minimal()
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable(booktabs = T) %>%
kable_styling()
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable(booktabs = T) %>%
kable_styling() %>%
kable_material_dark()
able_styling()
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(booktabs = T) %>%
add_header_above(c("Mes con mas demanda general" = 2)) %>% kable_styling()
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique(booktabs = T) %>%  kable() %>%
add_header_above(c("Mes con mas demanda en cada anho" = 3)) %>% kable_styling()
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(caption = "Recreating booktabs style table") %>%
add_header_above(c("Mes con mas demanda general" = 2)) %>% kable_styling()
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda en cada anho") %>% kable_styling()
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling()
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda en cada anho") %>% kable_styling(bootstrap_options = "striped", full_width = F)
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(3:5, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec( bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda en cada anho") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda en cada anho") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:2, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(hr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(hr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(hr, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda en cada anho") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:2, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(hr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(hr, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda en cada anho") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:2, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(hr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(hr, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(hr) %>% mutate(
cantidad = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(hr, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(hr) %>% mutate(
cantidad = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Hora con mas demanda" = hr, "Demanda promedio" = demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth) %>% mutate(
cantidad = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth) %>% mutate(
cantidad = max(cnt),
cantidad_promedio = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth) %>% mutate(
cantidad = max(cnt),
cantidad_promedio = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Mes" = mnth,  "Total demanda " = demanda , "Promedio" = cantidad_promedio) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda en cada anho") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:2, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth) %>% mutate(
cantidad = max(cnt),
cantidad_promedio = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Mes" = mnth,  "Total demanda " = demanda , "Promedio" = cantidad_promedio) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth) %>% mutate(
cantidad = max(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Mes" = mnth,  "Total demanda " = demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda en cada anho") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:2, bold = T, color = "white", background = "#D7261E")
datos <- datos %>% mutate(
yr = substr(dteday, 0 , 4)
)
datos %>% group_by(mnth, yr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>%  group_by(yr) %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select(yr, mnth, demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda en cada anho") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:2, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth) %>% mutate(
cantidad = max(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Mes" = mnth,  "Total demanda " = demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(mnth) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Mes" = mnth,  "Total demanda " = demanda) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(hr) %>% mutate(
cantidad = max(cnt)
promedio = mean(cnt)
datos %>% group_by(hr) %>% mutate(
cantidad = max(cnt),
promedio = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Hora con mas demanda" = hr, "Demanda total" = demanda,  "Demanda promedio" = promedio,) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(hr) %>% mutate(
cantidad = sum(cnt),
promedio = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Hora con mas demanda" = hr, "Demanda total" = demanda,  "Demanda promedio" = promedio,) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
View(datos)
datos %>% group_by(season) %>% mutate(
cantidad = sum(cnt),
promedio = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Temporada" = hr, "Demanda total" = demanda,  "Demanda promedio" = promedio,) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(hr) %>% mutate(
cantidad = sum(cnt),
promedio = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Hora con mas demanda" = hr, "Demanda total" = demanda,  "Demanda promedio" = promedio,) %>% unique() %>%  kable(caption = "Hora con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(hr) %>% mutate(
cantidad = sum(cnt),
promedio = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Hora (HH)" = hr, "Demanda total" = demanda,  "Demanda promedio" = promedio,) %>% unique() %>%  kable(caption = "Hora con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(season) %>% mutate(
cantidad = sum(cnt),
promedio = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Temporada" = hr, "Demanda total" = demanda,  "Demanda promedio" = promedio,) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(season) %>% mutate(
cantidad = sum(cnt),
promedio = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Temporada" = season, "Demanda total" = demanda,  "Demanda promedio" = promedio,) %>% unique() %>%  kable(caption = "Mes con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(season) %>% mutate(
cantidad = sum(cnt),
promedio = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Temporada" = season, "Demanda total" = demanda,  "Demanda promedio" = promedio) %>% unique() %>%  kable(caption = "Temporada con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
season,
datos %>% group_by(season) %>% mutate(
cantidad = sum(cnt),
promedio = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>%
mutate(season = recode(
season,
"1" = "spring",
"2" = "summer",
"3" = "fall",
"4" = "winter")
) %>% select("Temporada" = season, "Demanda total" = demanda,  "Demanda promedio" = promedio) %>% unique() %>%  kable(caption = "Temporada con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(hr) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Hora (HH)" = hr, "Demanda total" = demanda) %>% unique() %>%  kable(caption = "Hora con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(season) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>%
mutate(season = recode(
season,
"1" = "Spring",
"2" = "Summer",
"3" = "Fall",
"4" = "Winter")
) %>% select("Temporada" = season, "Demanda total" = demanda) %>% unique() %>%  kable(caption = "Temporada con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Temporada" = season, "Demanda total" = demanda) %>% unique() %>%  kable(caption = "Temporada con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Temperatura" = season, "Demanda total" = demanda) %>% unique() %>%  kable(caption = "Temporada con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Temperatura" = temp, "Demanda total" = demanda) %>%  kable(caption = "Temporada con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(season) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>%
mutate(season = recode(
season,
"1" = "Spring",
"2" = "Summer",
"3" = "Fall",
"4" = "Winter")
) %>% select("Temporada" = season, "Demanda total" = demanda) %>% unique() %>%  kable(caption = "Temporada con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
# 4. ¿A que temperatura baja la demanda?
```{r pregunta_4, echo=FALSE}
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% filter(demanda == cantidad) %>% select("Temperatura" = temp, "Demanda total" = demanda) %>%  kable(caption = "Temporada con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% select("Temperatura" = temp, "Demanda total" = demanda) %>% unique() %>%  kable(caption = "Temporada con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% select("Temperatura" = temp, "Demanda total" = demanda) %>% unique() %>% order()
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% select("Temperatura" = temp, "Demanda total" = demanda) %>% unique() %>% desc()
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% select("Temperatura" = temp, "Demanda total" = demanda) %>% unique() %>% arrange()
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% select("Temperatura" = temp, "Demanda total" = demanda) %>% unique() %>% arrange(Temperatura)
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% select("Temperatura" = temp, "Demanda total" = cantidad) %>% unique() %>% arrange(Temperatura)
library(gplot2)
library(ggplot2)
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% select("Temperatura" = temp, "Demanda total" = cantidad) %>% unique() %>% arrange(Temperatura) %>% ggplot(aes(temp, cantidad))
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% select("Temperatura" = temp, "Demanda total" = cantidad) %>% unique() %>% arrange(Temperatura) %>% ggplot(aes(temp, cantidad)) + geom_line()
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% select("Temperatura" = temp, "Demanda" = cantidad) %>% unique() %>% arrange(Temperatura) %>% ggplot(aes(Temperatura, Demanda)) + geom_line()
install.packages("nycflights13")
install.packages("ISLR")
datos %>% glimpse()
datos %>% group_by(hum) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  max(cantidad)
)  %>% select("Humedad" = hum, "Demanda" = cantidad) %>% unique() %>% arrange(Humedad) %>% ggplot(aes(Humedad, Demanda)) + geom_line()
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% select("Temperatura" = temp, "Demanda" = cantidad) %>% unique() %>% arrange(Temperatura) %>% ggplot(aes(Temperatura, Demanda)) + geom_line()
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  min(cantidad)
)  %>% select("Temperatura" = temp, "Demanda" = cantidad) %>% unique() %>%  kable(caption = "Temperatura con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  min(cantidad)
)  %>% select("Temperatura" = temp, "Demanda" = demanda) %>% unique() %>%  kable(caption = "Temperatura con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  min(cantidad)
)  %>% select("Temperatura" = temp, "Demanda" = demanda) %>% unique() %>%  arrange(Temperatura) %>% %>%  kable(caption = "Temperatura con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(temp) %>% mutate(
cantidad = sum(cnt)
) %>% ungroup() %>% mutate(
demanda =  min(cantidad)
)  %>% select("Temperatura" = temp, "Demanda" = demanda) %>% unique() %>%  arrange(Temperatura) %>%  kable(caption = "Temperatura con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
datos %>% group_by(temp) %>% mutate(
cantidad = mean(cnt)
) %>% ungroup() %>% mutate(
demanda =  min(cantidad)
)  %>% select("Temperatura" = temp, "Demanda" = demanda) %>% unique() %>%  arrange(Temperatura) %>%  kable(caption = "Temperatura con mas demanda general") %>% kable_styling(bootstrap_options = "striped", full_width = F) %>% row_spec(1:1, bold = T, color = "white", background = "#D7261E")
install.packages("caret")
install.packages("caret")
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(dplyr)
library(knitr)
library(kableExtra)
library(dplyr)
library(knitr)
library(kableExtra)
library(ggplot2)
# 1. ¿Qué mes es el que tiene la mayor demanda?
# 2. ¿Qué rango de hora es la de mayor demanda?
# 3. ¿Qué temporada es la mas alta?
# 4. ¿A que temperatura baja la demanda?
# 4. ¿A que humedad baja la demanda?
as
